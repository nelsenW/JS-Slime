!function(){"use strict";!function(){const e={red:{lighterShade:[237,151,162],lightShade:[227,99,116],baseShade:[215,38,61],darkShade:[173,31,50],darkerShade:[121,21,35]},orange:{lighterShade:[246,186,162],lightShade:[241,144,106],baseShade:[235,94,40],darkShade:[205,72,19],darkerShade:[149,52,14]},yellow:{lighterShade:[248,232,180],lightShade:[243,215,124],baseShade:[238,198,67],darkShade:[224,177,21],darkerShade:[168,132,16]},green:{lighterShade:[101,246,149],lightShade:[43,243,110],baseShade:[12,202,74],darkShade:[9,154,57],darkerShade:[6,96,36]},blue:{lighterShade:[163,192,244],lightShade:[109,154,238],baseShade:[54,11,231],darkShade:[24,86,201],darkerShade:[17,62,146],163:"lighterShade",109:"lightShade",54:"baseShade",24:"darkShade",17:"darkerShade"},violet:{lighterShade:[112,95,171],lightShade:[85,70,134],baseShade:[57,47,90],darkShade:[34,28,53],darkerShade:[9,7,13]},pink:{lighterShade:[255,184,209],lightShade:[255,133,175],baseShade:[255,71,136],darkShade:[255,31,109],darkerShade:[204,0,71]}};class t{constructor(t,s,i){this.ctx=t,this.pos=i,this.color=s,this.baseShade=e[s].baseShade,this.width=64,this.height=22}animate(){const t=document.querySelector("#pad-sheet");let s=64*Object.keys(e).indexOf(this.color);this.ctx.drawImage(t,s,0,this.width,this.height,this.pos[0],this.pos[1],this.width,this.height)}}class s{constructor(e,t,s,i){this.ctx=e,this.canvas=t,this.monitorText="",this.slime=i,this.objects=this.optionsBreaker(s)}optionsBreaker(e){return this.monitorText=e.monitorText,this.tileMapping(e.tileArray)}tileMapping(e){let s=[],a=this.canvas.width/e[0].length,o=this.canvas.height/e.length;for(let l=0;l<e.length;l++)for(let r=0;r<e[0].length;r++){let n=r*a,c=l*o;switch(e[l][r]){case" ":break;case"e":s.push(new h(this.ctx,[n,c],a,o));break;case"#":s.push(new i(this.ctx,[n,c],a,o));break;case"r":s.push(new t(this.ctx,"red",[n,c]));break;case"o":case"p":s.push(new t(this.ctx,"orange",[n,c]));break;case"y":s.push(new t(this.ctx,"yellow",[n,c]));break;case"g":s.push(new t(this.ctx,"green",[n,c]));break;case"v":s.push(new t(this.ctx,"violet",[n,c]));break;case"s":this.slime.vel=[0,0],this.slime.pos=[n,c]}}return s}}class i{constructor(e,t,s,i){this.ctx=e,this.pos=t,this.width=s,this.height=i,this.color="slategrey"}animate(){this.ctx.fillStyle=this.color,this.ctx.fillRect(this.pos[0],this.pos[1],this.width,this.height)}}class h{constructor(e,t,s,i){this.ctx=e,this.pos=t,this.width=s,this.height=i,this.color="darkgrey"}animate(){this.ctx.fillStyle=this.color,this.ctx.fillRect(this.pos[0],this.pos[1],this.width,this.height)}}const a={rangedAttack:14,meleeAttack:10,death:11,dash:4,hurt:2,move:7,crouch:9,idle:9,jump:6,land:8};class o{constructor(e,t,s,i){this.pos=e,this.vel=[0,0],this.game=t,this.color="blue",this.canvas=i,this.ctx=s,this.gravity=0,this.terminal_vel=12,this.grav_dir=1,this.jumpCount=0,this.jumpCountMax=1,this.state="idle",this.landing=!1,this.health=64,this.radius=this.health/2,this.healthRegen=!1,this.damage=10,this.redDmgMod=2,this.ignoreCollision=!1,this.dashCount=0,this.dashCountMax=0,this.floorColor=null,this.moving=!1}animate(e,t){const s=document.querySelector("#slime-sheet");let i=Math.floor(e/t)%a[this.state];"crouch"===this.state&&45===e&&(i=8);let h=128*i,o=128*Object.keys(a).indexOf(this.state);if("blue"!==this.color){this.ctx.drawImage(s,h,o,128,128,this.pos[0],this.pos[1],this.health,this.health);let e=this.focus(this.color);this.ctx.putImageData(e,this.pos[0],this.pos[1])}else this.ctx.drawImage(s,h,o,128,128,this.pos[0],this.pos[1],this.health,this.health);"land"===this.state&&7===i?this.landing=!0:"dash"===this.state&&3===i?(this.vel[0]/=3,this.state="idle"):"rangedAttack"===this.state&&13===i?(this.rangedAttack(),this.moving=!1):"meleeAttack"===this.state&&9===i&&(this.meleeAttack(),this.moving=!1)}updatepos(){this.pos[0]+=this.vel[0],this.vel[1]<this.terminal_vel&&(this.vel[1]+=this.gravity),this.pos[1]+=this.vel[1]}move(e){switch(e){case"jump":this.jumpCount>0&&(this.state="jump","pink"===this.color&&1===this.jumpCount?this.vel[1]-=20:(this.vel[1]=this.terminal_vel,this.vel[1]-=30),this.jumpCount--,this.landing=!1);break;case"move left":this.moving=!0,this.state="move",this.vel[0]=-8;break;case"move right":this.moving=!0,this.vel[0]=8,this.state="move";break;case"crouch":this.crouch();break;case"stop":this.moving=!1,this.state="idle",this.vel[0]=0;break;case"dash":this.dashCount--,this.state="dash",this.vel[0]*=3;break;case"meleeAttack":this.moving=!0,this.state="meleeAttack";break;case"rangedAttack":this.moving=!0,this.state="rangedAttack"}}crouch(){this.state="crouch",this.moving=!0}meleeAttack(){}rangedAttack(){}focus(t){let s=this.ctx.getImageData(this.pos[0],this.pos[1],64,64),i=[];for(let e=3;e<s.data.length;e+=4)i.push(s.data[e]),s.data[e]=0;for(let i=0;i<s.data.length;i+=4){let h=e.blue[s.data[i]];h&&(s.data[i]=e[t][h][0],s.data[i+1]=e[t][h][1],s.data[i+2]=e[t][h][2])}for(let e=3;e<s.data.length;e+=4)s.data[e]=i[(e+1)/4];return s}isCollidedWith(e){if(this.exited=!1,this.horizontalCollision(e)){for(e instanceof h&&(this.exited=!0);this.horizontalCollision(e);)this.pos[0]-=0===Math.sign(this.vel[0])?-1:Math.sign(this.vel[0]);this.vel[0]=0}if(this.verticalCollision(e)){for(;this.verticalCollision(e);)0===this.vel[1]&&(this.vel[1]=-1),this.pos[1]-=Math.sign(this.vel[1]);this.vel[1]=0,this.floorColor=null,this.jumpCount<this.jumpCountMax&&(this.state="land",this.jumpCount++),this.dashCount<this.dashCountMax&&this.dashCount++,e instanceof t&&(this.floorColor=e.color),this.landing&&!this.moving&&(this.state="idle"),e instanceof h&&(this.exited=!0)}}verticalCollision(e){let t=e.pos[0],s=e.pos[0]+e.width,i=e.pos[1],h=e.pos[1]+e.height;return this.pos[1]+1.5*this.radius+this.vel[1]>=i&&this.pos[1]+this.radius<=h&&this.pos[0]+2*this.radius-this.vel[0]>=t&&this.pos[0]<=s}horizontalCollision(e){let t=e.pos[0],s=e.pos[0]+e.width,i=e.pos[1],h=e.pos[1]+e.height;return this.pos[0]+2*this.radius>=t&&this.pos[0]<=s&&this.pos[1]+this.radius>=i&&this.pos[1]<=h}resetStats(){this.color="blue",this.jumpCountMax=1,this.jumpCount=0,this.ignoreCollision=!1,this.dashCount=0,this.dashCountMax=0,this.healthRegen=!1,this.damage/=this.redDmgMod,this.gravity=.98}}const l={1:{monitorText:"Welcome to the test lab subject #8X75G2, please proceed to the right to begin testing...",tileArray:["###################","#                 #","#                 #","#                 #","#                 #","#         #       #","#                 e","###################"]},2:{monitorText:"For each test all we need to do is make it to the other side of the room...",tileArray:["###################","#                 #","#                 #","#                 #","#                 #","#                 #","#s       #        e","###################"]},3:{monitorText:"To move back and forth in the current room use the arrow keys to your advantage...               Wait until Im done talking jeez...",tileArray:["###################","#                 #","#                 #","#                 #","#                 e","#            ###  #","#s         # # # ##","###################"]},4:{monitorText:"Money is tight so if you are dumb enough to fall in a hole we will just get a new test subject...",tileArray:["###################","#                 #","#                 #","#                 #","#                 #","#                 #","#s                e","##########  #######"]},5:{}};class r{constructor(e,t){var i,h;h=e=>new Promise((t=>setTimeout(t,e))),(i="typeSpeed")in this?Object.defineProperty(this,i,{value:h,enumerable:!0,configurable:!0,writable:!0}):this[i]=h,this.ctx=e,this.canvas=t,this.slime=new o([.54*this.canvas.width,.42*this.canvas.height],this,this.ctx,this.canvas),this.currentLevel=1,this.level=new s(this.ctx,this.canvas,l[this.currentLevel],this.slime),this.frame=0,this.stagger=5,this.allObjects=this.level.objects,this.tutorialFinished=!1,this.generateLevel()}step(){this.moveObjects(),this.checkCollisions()}draw(e,t){e.clearRect(0,0,t.width,t.height),this.allObjects.forEach((e=>{e.animate(this.frame,this.stagger)})),this.slime.animate(this.frame,this.stagger),this.frame++}moveObjects(){this.slime.updatepos()}checkCollisions(){for(let e=0;e<this.allObjects.length;e++)this.slime.isCollidedWith(this.allObjects[e]),this.slime.exited&&!0===this.tutorialFinished&&this.nextLevel()}checkGameStatus(){return this.slime.pos[1]>this.canvas.height||this.slime.health<=0}nextLevel(){this.slime.exited=!1,this.currentLevel++,this.level=new s(this.ctx,this.canvas,l[this.currentLevel],this.slime),this.allObjects=this.level.objects,this.tutorialFinished=!1,this.generateLevel()}async generateLevel(){const e=document.querySelector("#monitor-text");e.textContent="";let t=this.level.monitorText;for(let s=0;s<t.length;s++)await this.typeSpeed(50),e.textContent+=t[s];this.tutorialFinished=!0}}class n{constructor(e,t){this.ctx=e,this.canvas=t,this.game=new r(this.ctx,this.canvas),this.paused=!1,this.pauseMenu=document.getElementById("pause-menu"),this.gameOverScreen=document.querySelector(".game-over-screen"),this.gameOverMenu=document.querySelector("#game-over-menu"),this.pauseMenu.addEventListener("click",this.pauseCallback.bind(this))}start(){window.requestAnimationFrame(this.gameLoop.bind(this))}gameLoop(){if(!this.paused){if(this.game.checkGameStatus())return this.gameOverScreen.style.display="flex",void(this.gameOverMenu.style.display="flex");this.game.step(),this.game.draw(this.ctx,this.canvas),window.requestAnimationFrame(this.gameLoop.bind(this))}}pause(){this.pauseMenu.style.display="flex",this.paused=!0}pauseCallback(e){const t=document.getElementById("resume");e.target===t&&this.resume()}resume(){this.pauseMenu.style.display="none",this.paused=!1,this.gameLoop()}bindKeyHandlers(){window.addEventListener("keydown",(e=>{switch(e.code){case"Space":this.game.slime.resetStats();break;case"ArrowUp":!0===this.game.slime.landing&&(this.game.frame=0),this.game.slime.move("jump");break;case"ArrowLeft":this.game.slime.move("move left");break;case"ArrowRight":this.game.slime.move("move right");break;case"ArrowDown":this.game.frame>45?this.game.frame=0:this.game.frame>40&&(this.game.frame=40),this.game.slime.move("crouch");break;case"KeyD":this.game.slime.dashCount>=this.game.slime.dashCountMax&&"yellow"===this.game.slime.color&&(this.game.frame=0,this.game.slime.move("dash"));break;case"KeyF":let e=this.game.slime.floorColor;if("blue"===this.game.slime.color)switch(e){case"red":this.game.slime.damage*=this.game.slime.redDmgMod,this.game.slime.color="red";break;case"orange":this.game.slime.color="orange";break;case"yellow":this.game.slime.dashCountMax=1,this.game.slime.color="yellow";break;case"green":this.game.slime.color="green",this.game.slime.healthRegen=!0;break;case"violet":this.game.slime.color="violet",this.game.slime.ignoreCollision=!0;break;case"pink":this.game.slime.jumpCountMax=2,this.game.slime.color="pink"}break;case"KeyP":this.pause();break;case"KeyA":this.game.slime.move("meleeAttack"),this.game.frame=0;break;case"KeyS":this.game.slime.move("rangedAttack"),this.game.frame=0}})),window.addEventListener("keyup",(e=>{switch(e.code){case"ArrowRight":case"ArrowLeft":case"ArrowDown":this.game.slime.move("stop")}}))}}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("startgame"),t=document.querySelector(".start-menu"),s=document.getElementById("close-button"),i=document.getElementById("close-button2"),h=document.getElementById("about"),a=document.querySelector(".about-menu"),o=document.querySelector("#controls"),l=document.querySelector(".controls-menu"),r=document.querySelector(".game-over-screen"),c=document.querySelector("#game-over-menu"),d=document.getElementById("retry"),m=document.querySelector("#canvas"),g=m.getContext("2d"),u=["red","orange","yellow","green","blue","violet","pink"];m.height=window.innerHeight,m.width=window.innerWidth;let p=new n(g,m);p.start(),d.addEventListener("click",(()=>{r.style.display="none",c.style.display="none",p=new n(g,m),p.start(),k()}));let v=5,y=setInterval((()=>{p.game.slime.color=u[v%7],v++}),500);const k=()=>{p.game.slime.color="blue",p.bindKeyHandlers(),p.game.slime.gravity=.98};e.addEventListener("click",(()=>{clearInterval(y),t.style.display="none",k()})),h.addEventListener("click",(()=>{t.style.display="none",a.style.display="flex"})),o.addEventListener("click",(()=>{t.style.display="none",l.style.display="flex"})),s.addEventListener("click",(()=>{a.style.display="none",t.style.display="flex"})),i.addEventListener("click",(()=>{t.style.display="flex",l.style.display="none"}))}))}()}();
//# sourceMappingURL=main.js.map